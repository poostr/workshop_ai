# Отчёт по задаче API-004

## Статус

Выполнено.

## Что сделано

- Реализован endpoint `GET /api/v1/types/{id}` в `backend/app/api/v1/router.py`:
  - добавлена выборка типа по `id` с `LEFT JOIN` к `stage_counts`;
  - ответ возвращается в формате `TypeListItem` с полным набором стадий;
  - при отсутствии типа возвращается `404` с сообщением `Type not found.`.
- Выполнен рефакторинг роутера для снижения дублирования:
  - добавлен helper `_build_type_item` для инициализации counts;
  - добавлен helper `_apply_stage_count` для заполнения counts из stage rows;
  - `GET /types` и `POST /types` переведены на переиспользование этих helper-функций.
- Добавлены интеграционные тесты `backend/tests/test_type_details_api.py`:
  - успешное получение деталей существующего типа;
  - корректная обработка запроса несуществующего `type_id` (`404`).
- В `BACKLOG.md` задача `API-004` помечена выполненной.
- В `CHANGELOG.md` добавлена запись по `API-004`.

## Верификация

- `make quality` — успешно (backend format/lint/tests, frontend format/lint/typecheck/build/test).

## Принятые решения

- ADR: [`ADR-0015`](../ADR/ADR-0015-type-details-endpoint-api-004.md)
