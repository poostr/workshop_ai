# Отчёт по задаче API-001

## Статус

Выполнено.

## Что сделано

- Реализован единый контракт ошибок API:
  - добавлен `backend/app/api/v1/errors.py` с `ErrorCode`, `ApiContractError` и централизованными exception handlers;
  - формат ошибок унифицирован до JSON-структуры `{code, message}`.
- Добавлены Pydantic-схемы API в `backend/app/api/v1/schemas.py`:
  - `ApiStatusResponse`, `ErrorResponse`, `TypeMoveRequest`;
  - для `TypeMoveRequest` включена строгая валидация (`strict=True`, `extra='forbid'`, `qty > 0`).
- Обновлён контракт стадий:
  - в `backend/app/domain/stages.py` введён enum `StageCode`;
  - `STAGES` теперь формируется из `StageCode`.
- `GET /api/v1/status` переведён на response schema (`ApiStatusResponse`) в `backend/app/api/v1/router.py`.
- В `backend/app/main.py` зарегистрированы централизованные обработчики ошибок API.
- Добавлены тесты `backend/tests/test_api_contracts.py`:
  - проверка формата бизнес-ошибок;
  - проверка формата ошибок валидации;
  - проверка strict-валидации входа.
- В `BACKLOG.md` задача `API-001` помечена выполненной.
- В `CHANGELOG.md` добавлена запись по `API-001`.

## Верификация

- `make quality` — успешно (backend format/lint/tests, frontend format/lint/typecheck/build/test).

## Принятые решения

- ADR: [`ADR-0012`](../ADR/ADR-0012-api-contracts-validation-and-error-format.md)
