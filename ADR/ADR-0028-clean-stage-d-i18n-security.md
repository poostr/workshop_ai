# ADR-0028: Приборка этапа D — удаление неиспользуемых i18n-ключей и security-аудит

## Статус
Принято

## Контекст
После завершения этапа D (Frontend SPA) проведён ревью кода на предмет:
- неиспользуемых компонентов и i18n-ключей;
- утечек данных через консоль (запрет на логирование экспорта/импорта);
- корректности настроек безопасности (CORS, proxy, валидации).

## Решение

### Удалённые i18n-ключи
1. **`nav.main`** (RU: «Главная», EN: «Main») — после рефакторинга `AppLayout` навигация была сведена к ссылке-заголовку. Секция `nav` стала пустой и удалена целиком.
2. **`importExport.importError`** (RU: «Ошибка импорта.», EN: «Import error.») — ошибки импорта отображаются через централизованный хелпер `getLocalizedErrorMessage`, который маппит серверные коды через `errors.*`. Отдельный ключ `importError` не использовался.

### Не удалённые дубли типов
`ExportStageCount`/`ImportStageCount` и `ExportHistoryItem`/`ImportHistoryItem` на фронтенде структурно идентичны, но зеркалят отдельные Pydantic-схемы бэкенда с разным уровнем валидации (Import — `extra="forbid"`, strict-поля). Решено сохранить разделение для контрактной ясности.

### Результаты security-аудита
- **CORS**: явный allowlist localhost-origin, `allow_credentials=False`, ограниченные методы.
- **Nginx proxy**: `^~ /api/` исключает перехват другими location-блоками; `proxy_redirect off`.
- **Логи**: ноль `console.log`/`console.warn`/`console.error` в frontend; ноль `print()`/`logging.*` в backend.
- **Валидация**: backend — `extra="forbid"`, strict-поля, `model_validator`; frontend — клиентская JSON-валидация перед отправкой.

## Последствия
- Словари i18n содержат только используемые ключи.
- Security-профиль локального окружения подтверждён.
