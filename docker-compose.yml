services:
  app:
    image: python:3.12-slim
    container_name: miniatures-app
    env_file:
      - .env
    command: ["bash", "-lc", "echo 'INIT-001 scaffold: app placeholder' && sleep infinity"]
    working_dir: /workspace/backend
    volumes:
      - ./:/workspace
    depends_on:
      - postgres

  postgres:
    image: postgres:16-alpine
    container_name: miniatures-postgres
    env_file:
      - .env
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  nginx:
    image: nginx:1.27-alpine
    container_name: miniatures-nginx
    ports:
      - "8080:80"
    volumes:
      - ./ops/nginx/default.conf:/etc/nginx/conf.d/default.conf:ro
      - ./frontend:/usr/share/nginx/html:ro
    depends_on:
      - app

volumes:
  postgres_data:

