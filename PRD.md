# PRD — Miniatures Progress Tracker (v1)

**Date:** 2026-02-16  
**Author (GitHub login):** copilot25atisu  
**Version:** v1 (scope locked)

## 1. Goal
Приложение/инструмент для учёта количества миниатюр по стадиям готовности (pipeline) с быстрым перемещением между стадиями и просмотром истории изменений.

## 2. Core entities
### 2.1 Miniature Type (Тип миниатюр)
- **Name** (string) — **уникальное** (нельзя создать/переименовать так, чтобы дублировалось).
- **Counts by stage** — количества по каждой стадии.
- **History log** — список событий изменений (см. раздел 5).

## 3. Stages (pipeline)
Фиксированный порядок стадий (англ. UI-термины для v1):
1. **In box**
2. **Building**
3. **Priming**
4. **Painting**
5. **Done** (финальная)

Правила:
- Перемещение допускается **только вперёд** по стадиям.
- Стадия **Done** — финальная: перемещение **назад запрещено**.

## 4. Main screen (список типов)
- Список типов миниатюр.
- **Sorting:** по названию **А‑Я** (алфавит).
- **Search:** есть строка поиска по названию типа.
- **Empty state:** если типов нет, показываем пустой экран с CTA **«Добавить тип»** (не авт-открывать модалку).

## 5. Type details (карточка типа)
Должна содержать:
- Текущие количества по стадиям.
- UI для перемещения количества со стадии X на стадию Y (вперёд).

### 5.1 Max available rule (ограничение на количество)
Если пользователь выбирает источник **X** и цель **Y**, то:
- **max допустимое количество = текущее количество в стадии X**
- UI должен явно показывать ограничение (например, “Доступно: N”).
- Нельзя выполнить операцию на количество больше доступного.

## 6. History (лог событий)
- В карточке типа есть вкладка/раздел **History (История)**.
- История состоит из событий “перемещение” вида **X → Y** с количеством (qty) и временем.

### 6.1 Grouping rule (группировка истории)
Соседние события в истории **группируются**, если:
- переход одинаковый (**одинаковый X→Y**),
- и события идут подряд,
- и разница по времени между ними не превышает **5 минут** (300 секунд).

**Timestamp отображения для группы:** показываем время **начала** группы (вариант C).

> Примечание: формат строки группы остаётся UI-деталью, но семантика времени — “start of group”.

## 7. Data storage, export/import
### 7.1 Storage
- В v1 данные хранятся **локально** (без аккаунта/сервера).
- Но заложить возможность **экспорт/импорт**.

### 7.2 Export
- Формат: **JSON**.
- Экспорт включает:
  - текущее состояние (counts по стадиям),
  - **и** историю (log).

### 7.3 Import (merge behavior)
При импорте JSON поверх существующих данных:
- Импорт выполняется как **merge по имени типа**.
- Если имя типа совпадает:
  - **количества по стадиям складываются** (stage-wise sum),
  - **история дописывается** (append).
- **Deduplication истории не делаем**: при повторном импорте одного и того же файла дубли событий допускаются.

## 8. Localization (i18n)
- В v1 поддерживаем **RU + EN**.
- Все строки должны быть через **словари/ресурсы** (ключи + ru/en), без хардкода.

## 9. Out of scope (явно)
- Аккаунт/логин/облачная синхронизация между устройствами (в v1 нет).
- Дедупликация истории при импорте (в v1 нет).
- Ручная сортировка типов (drag&drop) (в v1 нет).