# ADR-0032: E2E Smoke Test (QA-005)

**Дата:** 2026-02-26
**Статус:** Принят
**Задача:** QA-005

## Контекст

Необходим минимальный e2e smoke-тест, проверяющий основной сценарий:
создание типа → перемещение → экспорт → импорт (merge) → проверка истории.

## Решение

### API-level smoke вместо браузерного e2e

Выбран подход API-level smoke-теста (Python-скрипт на stdlib) вместо Playwright/Cypress:

- **Простота**: ноль дополнительных зависимостей (используется только `urllib` из stdlib Python).
- **Скорость**: тест проходит за ~1.5 секунды вместо минут на запуск браузера.
- **Надёжность**: нет flaky-проблем с ожиданием элементов DOM.
- **Полнота**: покрывает весь backend-контракт, который является основой корректности.

Дополнительно добавлен ручной чеклист в `README.md` для UI-проверок (переключение языка, визуальные состояния).

### Уникальные имена типов

Каждый запуск создаёт тип с уникальным суффиксом-timestamp (`SmokeTest_{ms}`), чтобы:
- не конфликтовать с рабочими данными;
- не требовать teardown/cleanup.

### Поддержка двух точек входа

Скрипт принимает `BASE_URL` как аргумент:
- `http://localhost:8000/api/v1` — прямой доступ к backend (по умолчанию);
- `http://localhost:8080/api/v1` — через nginx, проверяя proxy-настройки.

## Последствия

- Добавлен `tests/e2e_smoke.py` — самодостаточный скрипт.
- Добавлен Makefile-таргет `make e2e-smoke` (с опциональным `E2E_BASE_URL`).
- README.md дополнен секцией «E2E Smoke Test» с инструкциями и ручным чеклистом.
